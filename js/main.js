function initMap(){mapZoom=window.innerWidth<730?12:15;var a={lat:42.194576,lng:-122.709477};map=new google.maps.Map(document.getElementById("map"),{center:a,zoom:mapZoom,mapTypeControl:!1,styles:[{featureType:"water",stylers:[{color:"#19a0d8"}]},{featureType:"administrative",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"},{weight:6}]},{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#e85113"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#efe9e4"},{lightness:-40}]},{featureType:"transit.station",stylers:[{weight:9},{hue:"e85113"}]},{featureType:"road.highway",elementType:"labels.icon",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#efe9e4"},{lightness:-25}]},{featureType:"poi.medical",stylers:[{color:"#0C479D"},{lightness:30}]},{featureType:"poi.business",elementType:"labels.text.fill",stylers:[{invert_lightness:!0},{color:"#0055ff"},{weight:.57}]}]}),infowindow=new google.maps.InfoWindow}function callYelp(){function a(){return Math.floor(1e12*Math.random()).toString()}var b="https://api.yelp.com/v2/search",c={location:"ashland+oregon",oauth_consumer_key:"bJ6MqThUNog4U8vA25ZD5Q",oauth_token:"OZWne-Ax7iRaccvd7uoAjnohr2-eh-u9",oauth_nonce:a(),oauth_timestamp:Math.floor(Date.now()/1e3),oauth_signature_method:"HMAC-SHA1",oauth_version:"1.0",callback:"cb"},d=oauthSignature.generate("GET",b,c,"L2veuSo8hUYFu77i2bFX3fqsm0c","uFqQIfacltRZEzKNvet6LEwgW7Y");c.oauth_signature=d;var e={url:b,data:c,cache:!0,dataType:"jsonp",jsonpCallback:"cb",success:function(a){for(var b,c=0;c<a.businesses.length;c++){b={};var d=a.businesses[c].image_url;b.name=a.businesses[c].name,b.id=c+1,b.location={lat:a.businesses[c].location.coordinate.latitude,lng:a.businesses[c].location.coordinate.longitude},b.image=d.replace("ms","l"),b.ratingImage=a.businesses[c].rating_img_url,b.reviewSnippet=a.businesses[c].snippet_text,b.reviewUrl=a.businesses[c].url,b.address=a.businesses[c].location.display_address[0]+", "+a.businesses[c].location.display_address[1],locations.push(new Place(b))}createMarker(),ko.applyBindings(new ViewModel)},error:function(){alert("Sorry, Yelp information not currently available")}};$.ajax(e)}function createMarker(){locations.forEach(function(a){function f(){locations.forEach(function(a){a.marker.clicked===!0&&(a.marker.clicked=!1,a.marker.setIcon(b))})}var b={url:"http://www.google.com/mapfiles/kml/paddle/blu-circle.png",scaledSize:new google.maps.Size(40,40)},c={url:"http://www.google.com/mapfiles/kml/paddle/ylw-circle.png",scaledSize:new google.maps.Size(40,40)},d={map:map,position:a.location,icon:b,animation:google.maps.Animation.DROP};a.marker=new google.maps.Marker(d);new google.maps.Marker({position:{lat:42.206443,lng:-122.72495},map:map,title:"Ashland Community Hospital, 280 Maple St."});a.marker.clicked=!1,a.marker.changeColor=function(){a.marker.setIcon(c)},a.marker.resetColor=function(){a.marker.clicked!==!0&&a.marker.setIcon(b)},google.maps.event.addListener(a.marker,"click",function(){f(),this.clicked=!0,toggleBounce(this),openInfowindow(a,a.marker)}),a.marker.click=function(){google.maps.event.trigger(a.marker,"click")},a.marker.addListener("mouseover",function(){this.clicked===!1&&this.changeColor()}),a.marker.addListener("mouseout",function(){this.clicked===!1&&this.resetColor()})})}function openInfowindow(a,b){var c='<div id="infoWindow"><div class = "place-name">'+a.name+'</div><img class = "rating" src="'+a.ratingImage+'"><img class = "place-image" src= "'+a.image+'"><div class = "reviews"><h3>Review Snippet</h3><p id="snippet">'+a.reviewSnippet+'</p></div><a href = "'+a.reviewUrl+'" target="_blank"> Click here to see more reviews </a></div>';infowindow.setContent(c),infowindow.open(map,b),google.maps.event.addListener(infowindow,"closeclick",function(){b.clicked=!1,b.resetColor(),map.panTo({lat:42.194576,lng:-122.709477})})}function toggleBounce(a){a.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){a.setAnimation(null)},2100)}function Place(a){this.name=a.name,this.location=a.location,this.id=a.id,this.image=a.image,this.marker=null,this.ratingImage=a.ratingImage,this.reviewSnippet=a.reviewSnippet,this.reviewUrl=a.reviewUrl,this.address=a.address}var locations=[],map,infowindow,mapZoom;initMap(),callYelp(),ko.bindingHandlers.autoComplete={init:function(a,b,c,d,e){var f=b(),g=f.selected,h=f.options,i=function(b,c){b.preventDefault(),$(a).val(c.item.label),"undefined"!=typeof c.item&&g(c.item)};$(a).autocomplete({source:h,select:function(a,b){i(a,b)},focus:function(a,b){i(a,b)},change:function(a,b){i(a,b)}})}};var ViewModel=function(){var a=this;a.points=ko.observableArray(locations),a.query=ko.observable(""),a.search=ko.computed(function(){return ko.utils.arrayFilter(a.points(),function(b){return b.name.toLowerCase().indexOf(a.query().toLowerCase())===-1?b.marker.setMap(null):b.marker.setMap(map),b.name.toLowerCase().indexOf(a.query().toLowerCase())>=0})}),a.locations=locations,a.selectedOption=ko.observable(""),a.options=a.locations.map(function(a){return{label:a.name,value:a.id,object:a}})};$("#place-toggle").click(function(){$("#place-list").toggle()});